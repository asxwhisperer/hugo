{{ define "main" }}
{{ $dateTime := .PublishDate.Format "2006-01-02" }}
{{ $dateFormat := .Site.Params.dateFormat | default "Monday, 2 January 2006" }}
<main id="" class="" style="margin-top: 30px;">
  <article class="page">
    <center><img class="title-logo" src="/content/logo.svg">
    <h1 class="page-title" style="margin-bottom: 1rem;"><a href="/">&lt;{{ .Title }}&gt;</a></h1>
    </center>
    <p>The Director's Commentary of the ASX</p>

    <p>I work in finance, my job requires me to read all the ASX announcements that come out each day. I pick out the most interesting, the most talked about, and the most impactful announcements that move the market.</p>
    
    <p>I stay updated, so you don't have to.</p>
    <hr>
    {{ partialCached "subscribe.html" . }}
    <hr>
  </article>  
  <div class="posts">
    {{ $paginator := .Paginate (where .Site.RegularPages "Type" "post") 10 }}
    {{ range $index, $page := $paginator.Pages }}
      {{ if in .Params.categories "linked" }}
        <article class="post linked">
        <h1 class="post-title">
          <a href="{{ replaceRE `[\s\S]*\[.*\]\((https?://\S+)\)[\s\S]*` `$1` .RawContent }}" class="linked-link" target="_blank">{{ safeHTML "&lt;LINK&gt;" }}</a>
      {{ else if in .Params.categories "sponsored" }}
        <article class="post spon">
        <h1 class="post-title">
          <a href="{{ replaceRE `[\s\S]*\[.*\]\((https?://\S+)\)[\s\S]*` `$1` .RawContent }}" class="spon-link" target="_blank">{{ safeHTML "&lt;SPON&gt;" }}</a>
      {{ else }}
        <article class="post whisperer">
        <h1 class="post-title">
          <a href="{{ replaceRE `[\s\S]*\[.*\]\((https?://\S+)\)[\s\S]*` `$1` .RawContent }}" class="whisperer link" target="_blank">{{ safeHTML "&lt;WHISP&gt;" }}</a>
      {{ end }}
          <a href="{{ .RelPermalink }}" class="linked-title">{{ .Title }}</a>
        </h1>
        <a class="post-date" datetime="{{ $dateTime }}">{{ .PublishDate.Format $dateFormat }}</a>
        <div class="post-content">
          {{ .Content }}
        </div>
      </article>
      <hr>
      
      {{ if (eq $index 5) }}
        <article class="adsense">
          <h1 class="adsense-header">
            <a class="spon-link" href="#">&lt;AD&gt;</a>
          </h1>
          <div class="adsense-container">
          {{ partial "adsense.html" . }}
          </div>
        </article>
        <hr>
      {{ end }}
      

      {{ if or (eq $index 2) (eq $index 7) }}
        <script src="https://shoutouts.lol/embed/6RFCLB-sGdKMPnkppGms.js" defer></script>
        <hr>
      {{ end }}
    {{ end }}
    {{ partial "pagination" . }}
  </div>
</main>
{{ end }}
